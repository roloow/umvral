<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>umVRal - Lanzamiento de Proyectil</title>
    <meta name="description" content="Experiencia VR de lanzamiento de proyectil.">
    <script src="assets/javascripts/aframe.min.js"></script>
    <script src="assets/javascripts/aframe-mouse-cursor-component.min.js"></script>
		<script src="assets/javascripts/aframe-physics-system.min.js"></script>
    <script src="assets/javascripts/aframe-material.min.js"></script>
    <script src="assets/javascripts/aframe-extras.min.js"></script>
    <script src="assets/javascripts/aframe-physics-extras.min.js"></script>
    <script src="assets/javascripts/moment-with-locales.js"></script>
    <script src="assets/javascripts/aframe-environment-component.min.js"></script>

    <script type="text/javascript">
      $ = (sel) => document.querySelector(sel)
      $$ = (sel) => document.querySelectorAll(sel)
      on = (elem, type, hand) => elem.addEventListener(type,hand)
    </script>
    <script type="text/javascript">
      AFRAME.ASSETS_PATH = "./assets";
    </script>
  </head>
  <body>
    <!-- Inicio Marco -->
    <a-scene id="source" cursor="rayOrigin: mouse" physics="driver: local; iterations: 100;">
      <a-assets>
        <a-mixin id="image" geometry="height: 2; width: 2"></a-mixin>
      </a-assets>
      <!-- Inicio de Controles -->
      <a-entity id="camWrapper" position="0 0 4">
        <a-entity id="cam" camera look-controls wasd-controls>
          <a-entity id="selector" cursor="fuse: true; fuseTimeout: 1000"
              position="0 0 -1"
              geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
              material="color: black; shader: flat">
              <a-animation begin="click" easing="ease-in" attribute="scale" dur="150" fill="forwards" from="0.1 0.1 0.1" to="1 1 1"></a-animation>
              <a-animation begin="cursor-fusing" easing="ease-in" attribute="scale" dur="1000" fill="backwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
            </a-entity>
        </a-entity>
      </a-entity>
      <!-- Fin de Controles -->
      <!-- Environment -->
      <a-entity id="env" environment="active: true; preset: egypt; skyType: atmosphere; ground: hills; playArea: 1.2; dressingAmount: 3; fog: 0.5;"></a-entity>
      <!-- /Environment -->

      <!-- ESCENA -->

      <!-- rack -->
      <a-assets>
        <a-asset-item id="tree-obj" src="/objetos/rack.obj"></a-asset-item>
        <a-asset-item id="tree-mtl" src="/objetos/rack.mtl"></a-asset-item>
      </a-assets>
      <a-entity obj-model="obj: #tree-obj; mtl: #tree-mtl" scale="0.01 0.01 0.01" rotation="-90 -50 0"></a-entity>
      <!-- /rack -->
      <!-- Pizarra OBJ-->
      <a-assets>
        <a-asset-item id="piz-obj" src="/objetos/pizarra.obj"></a-asset-item>
        <a-asset-item id="piz-mtl" src="/objetos/pizarra.mtl"></a-asset-item>
      </a-assets>
      <a-entity obj-model="obj: #piz-obj; mtl: #piz-mtl" scale="0.01 0.01 0.01" rotation="-90 -40 0"></a-entity>
      <!-- /Pizarra OBJ-->

      <a-assets>
        <a-asset-item id="cannon1-obj" src="/objetos/canongris.obj"></a-asset-item>
        <a-asset-item id="cannon1-mtl" src="/objetos/canongris.mtl"></a-asset-item>
        <a-asset-item id="cannon2-obj" src="/objetos/canonmadera.obj"></a-asset-item>
        <a-asset-item id="cannon2-mtl" src="/objetos/canonmadera.mtl"></a-asset-item>
        <a-asset-item id="cannon3-obj" src="/objetos/canonjade.obj"></a-asset-item>
        <a-asset-item id="cannon3-mtl" src="/objetos/canonjade.mtl"></a-asset-item>
      </a-assets>
      <a-entity obj-model="obj: #cannon3-obj; mtl: #cannon3-mtl" scale="0.0008 0.0008 0.0008" rotation="90 -15 0" position="7 3.4 6"></a-entity>
      <a-entity obj-model="obj: #cannon2-obj; mtl: #cannon2-mtl" scale="0.0008 0.0008 0.0008" rotation="90 -15 0" position="7 2 6"></a-entity>
      <a-entity obj-model="obj: #cannon1-obj; mtl: #cannon1-mtl" scale="0.008 0.008 0.008" rotation="90 -35 0" position="7 4 6"></a-entity>

        <!-- Cañon -->
        <a-cylinder static-body class="cannon" position="3.5 1 0" radius="0.4" height="2" rotation="-45 -20 0" color="gray"></a-cylinder>
        <a-box position="3 0.3 0.6" height="0.8" width="4" rotation="0 -20 0" color="brown"></a-cylinder>

          <a-button id="v1" position="1 0.3 1" rotation="0 -20 0" name="velocidad1"  value="1"></a-button>
          <a-button id="v2" position="2 0.3 1" rotation="0 -20 0" name="velocidad2"  value="2"></a-button>
          <a-button id="v3" position="3 0.3 1" rotation="0 -20 0" name="velocidad3"  value="3"></a-button>
        <!-- /Cañon -->

        <!-- Bola de cañon -->
        <a-entity id="orange"
  								dynamic-body
  								geometry="primitive: sphere; radius: 0.2"
  								material="color: orange; shader: flat"
  								raycaster="showLine: false; objects: .blanco; useWorldCoordinates: false; origin: 0, 0, 0; direction: 1, 0, -1"
  								cursor=""
  								position="2 5 -5">
  			</a-entity>


      <!-- /ESCENA -->
    </a-scene>
    <script type="text/javascript">
      $('.cannon').addEventListener('click', function(){
        document.querySelector("#orange").body.position.set(4, 1.5, -0.5);
        document.querySelector("#orange").body.velocity.set(4, 6, -20);
      });
    </script>
  </body>
</html>
