<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <title>umVRal - Dilatacion Termica</title>
    <meta name="description" content="Experiencia VR Dilatación Termica.">

    <script src="assets/javascripts/aframe.min.js"></script>
    <script src="assets/javascripts/aframe-mouse-cursor-component.min.js"></script>
		<script src="assets/javascripts/aframe-physics-system.min.js"></script>
    <script src="assets/javascripts/aframe-material.min.js"></script>
    <script src="assets/javascripts/aframe-extras.min.js"></script>
    <script src="assets/javascripts/aframe-physics-extras.min.js"></script>
    <script src="assets/javascripts/moment-with-locales.js"></script>
    <script src="assets/javascripts/aframe-environment-component.min.js"></script>

    <script src="assets/javascripts/aframe-animation-component.min.js"></script>
    <script src="assets/javascripts/aframe-slice9-component.min.js"></script>

    <script type="text/javascript">
      $ = (sel) => document.querySelector(sel)
      $$ = (sel) => document.querySelectorAll(sel)
      on = (elem, type, hand) => elem.addEventListener(type,hand)
    </script>
    <script type="text/javascript">
      AFRAME.ASSETS_PATH = "./assets";
    </script>
  </head>
  <body>
    <!-- Inicio Marco -->
    <a-scene id="source" cursor="rayOrigin: mouse" physics="driver: local; iterations: 100;">
      <a-assets>
        <a-asset-item id="panel-obj" src="/objetos/meson.obj"></a-asset-item>
        <a-asset-item id="panel-mtl" src="/objetos/meson.mtl"></a-asset-item>
        <a-asset-item id="panelquimico-obj" src="/objetos/panelquimico.obj"></a-asset-item>
        <a-asset-item id="panelquimico-mtl" src="/objetos/panelquimico.mtl"></a-asset-item>
        <a-asset-item id="pared-obj" src="/objetos/paredlineal.obj"></a-asset-item>
        <a-asset-item id="pared-mtl" src="/objetos/paredlineal.mtl"></a-asset-item>
        <a-asset-item id="horno-obj" src="/objetos/horno.obj"></a-asset-item>
        <a-asset-item id="horno-mtl" src="/objetos/horno.mtl"></a-asset-item>
        <a-asset-item id="paredcircular-obj" src="/objetos/paredcircular.obj"></a-asset-item>
        <a-asset-item id="paredcircular-mtl" src="/objetos/paredcircular.mtl"></a-asset-item>
        <a-asset-item id="sistemaquimico-obj" src="/objetos/sistemaquimico.obj"></a-asset-item>
        <a-asset-item id="sistemaquimico-mtl" src="/objetos/sistemaquimico.mtl"></a-asset-item>

        <a-asset-item id="pizarra-obj" src="/objetos/pizarra.obj"></a-asset-item>
        <a-asset-item id="pizarra-mtl" src="/objetos/pizarra.mtl"></a-asset-item>
        <a-asset-item id="vaso-obj" src="/objetos/vasoquimico.obj"></a-asset-item>
        <a-asset-item id="vaso-mtl" src="/objetos/vasoquimico.mtl"></a-asset-item>
        <a-asset-item id="tabla-obj" src="/objetos/tablaperiodica.obj"></a-asset-item>
        <a-asset-item id="tabla-mtl" src="/objetos/tablaperiodica.mtl"></a-asset-item>
        <a-asset-item id="puerta-obj" src="/objetos/puerta_lab.obj"></a-asset-item>
        <a-asset-item id="puerta-mtl" src="/objetos/puerta_lab.mtl"></a-asset-item>
        <a-asset-item id="ventana-obj" src="/objetos/ventana_lab.obj"></a-asset-item>
        <a-asset-item id="ventana-mtl" src="/objetos/ventana_lab.mtl"></a-asset-item>
        <a-asset-item id="reja-obj" src="/objetos/reja_lab.obj"></a-asset-item>
        <a-asset-item id="reja-mtl" src="/objetos/reja_lab.mtl"></a-asset-item>

      </a-assets>




      <a-assets>
        <a-mixin id="image" geometry="height: 2; width: 2"></a-mixin>
      </a-assets>



      <a-entity id="env" environment="active: true; preset: dream; skyType: atmosphere; ground: hills; playArea: 5; dressingAmount: 0; fog: 0.5;skyColor:#000000;lightPosition:0 1 0;groundYScale:1;groundTexture:checkerboard;groundColor:#4d4d4d;groundColor2:#ffffff;"></a-entity>


      <a-plane id="techo" scale="50 50 50 " position="0 3.9 0" rotation="90 0 0 " material="color: white; shader: flat"></a-plane>

      <a-plane id="suelohorno" scale="4 4 4" position="-5 0.01 -5.5" rotation="270 0 0 " material="color: rgb(0,0,0); shader: flat"></a-plane>
      <a-plane id="fondohorno" scale="4 3 4" position="-5 1.5 -7.5" rotation="0 0 0" material="color: #4d4d4d; shader: flat"></a-plane>
      <a-plane id="lateral1horno" scale="4 3 4" position="-7 1.5 -5.5" rotation="0 90 0" material="color: grey; shader: flat"></a-plane>
      <a-plane id="lateral2horno" scale="4 3 4" position="-3 1.5 -5.5" rotation="0 270 0" material="color: grey; shader: flat"></a-plane>
      <a-plane id="techohorno" scale="4 4 4" position="-5 3 -5.5" rotation="90 0 0 " material="color: red; shader: flat"></a-plane>


      <a-plane id="suelorefri" scale="4 4 4" position="2 0.01 -5.5" rotation="270 0 0 " material="color: rgb(0,0,255); shader: flat"></a-plane>
      <a-plane id="fondorefri" scale="4 3 4" position="2 1.5 -7.5" rotation="0 0 0" material="color: #4d4d4d; shader: flat"></a-plane>
      <a-plane id="lateral1refri" scale="4 3 4" position="0 1.5 -5.5" rotation="0 90 0" material="color: grey; shader: flat"></a-plane>
      <a-plane id="lateral2refri" scale="4 3 4" position="4 1.5 -5.5" rotation="0 270 0" material="color: grey; shader: flat"></a-plane>
      <a-plane id="techorefri" scale="4 4 4" position="2 3 -5.5" rotation="90 0 0 " material="color: blue; shader: flat"></a-plane>

      <!-- adornos  -->
      <a-entity id="puerta1" obj-model="obj: #puerta-obj; mtl: #puerta-mtl" scale="0.009 0.008 0.007" position="7.5 -0.1 9.95" rotation="270 0 180"></a-entity>
      <a-entity id="puerta2" obj-model="obj: #puerta-obj; mtl: #puerta-mtl" scale="0.009 0.008 0.007" position="10 -0.1 7.5" rotation="270 0 -90"></a-entity>
      <a-entity id="ventana1" obj-model="obj: #ventana-obj; mtl: #ventana-mtl" scale="0.003 0.003 0.003" position="-13.02 3.2 7.1" rotation="270 0 90"></a-entity>
      <a-entity id="ventana2" obj-model="obj: #ventana-obj; mtl: #ventana-mtl" scale="0.003 0.003 0.003" position="-13.02 3.2 0.114" rotation="270 0 90"></a-entity>
      <a-entity id="ventana3" obj-model="obj: #ventana-obj; mtl: #ventana-mtl" scale="0.003 0.003 0.003" position="-4.3 3.2 9.9" rotation="270 0 0"></a-entity>
      <a-entity id="ventana4" obj-model="obj: #ventana-obj; mtl: #ventana-mtl" scale="0.003 0.003 0.003" position="3 3.2 9.9" rotation="270 0 0"></a-entity>
      <a-entity id="mesa1" obj-model="obj: #panel-obj; mtl: #panel-mtl" scale="0.001 0.001 0.001" position="4 0 4" rotation="270 0 90"></a-entity>
      <!--a-entity id="mesa2" obj-model="obj: #panel-obj; mtl: #panel-mtl" scale="0.001 0.001 0.001" position="0 0 7" rotation="270 0 0"></a-entity-->
      <a-entity id="mesa3" obj-model="obj: #panel-obj; mtl: #panel-mtl" scale="0.001 0.001 0.001" position="-9.5 0 4" rotation="270 0 90"></a-entity>
      <a-entity id="mesa4" obj-model="obj: #panel-obj; mtl: #panel-mtl" scale="0.001 0.001 0.001" position="-4 0 4" rotation="270 0 90"></a-entity>
      <a-entity id="tabla" obj-model="obj: #tabla-obj; mtl: #tabla-mtl" scale="0.0001 0.0001 0.0001" position="-13 1.5 0" rotation="270 0 90"></a-entity>
      <a-entity id="pizarra" obj-model="obj: #pizarra-obj; mtl: #pizarra-mtl" scale="0.012 0.008 0.009" position="0 0 9" rotation="270 0 0"></a-entity>

      <a-text id="txtPizarra" position="1.6 2 8.9" value="Dilatacion Termica \n " scale="1 1 1" rotation="0 180 0"></a-text>

      <a-entity id="reja1" obj-model="obj: #reja-obj; mtl: #reja-mtl" scale="0.01 0.001 0.01" position="1.8 0.015 -3.9" rotation="180 0 0"></a-entity>
      <a-entity id="reja2" obj-model="obj: #reja-obj; mtl: #reja-mtl" scale="0.01 0.001 0.01" position="-5 0.015 -3.9" rotation="180 0 0"></a-entity>

      <a-entity id="vaso" obj-model="obj: #vaso-obj; mtl: #vaso-mtl" scale="0.001 0.001 0.001" position="-3.7 0.73 3.7" rotation="270 0 90"></a-entity>
      <a-entity id="panelquimico" obj-model="obj: #panelquimico-obj; mtl: #panelquimico-mtl" scale="0.00025 0.00025 0.00025" position="0 -0.2 0" rotation="270 0 0"></a-entity>
      <a-entity id="sistemaquimico1" obj-model="obj:/objetos/sistemaquimico.obj;mtl:/objetos/sistemaquimico.mtl" scale="0.01 0.01 0.01" position="9.747582104015574 0 2.014189237890888" rotation="270 -90 0"></a-entity>
      <a-entity id="sistemaquimico2" obj-model="obj:/objetos/sistemaquimico.obj;mtl:/objetos/sistemaquimico.mtl" scale="0.01 0.01 0.01" position="-10.7 -0.03256746715209635 -3.281528527918544" rotation="270 0 0"></a-entity>
      <!-- fin adornos  -->

      <a-cone id="volverInicio" position="0 3 3" scale="0.4 0.7 0.4" material="color:#ff9d00;shader:flat" geometry="" rotation="180 0 0"></a-cone>

      <!-- btn Horno  -->
      <a-button id="botonhorno" scale="2 2 2" position="-6 3 -3.499" value="horno" button="buttonColor:#fd0e0b"></a-button>
      <a-button id="boton20horno" scale="1.1 1 1" position ="-8 0.8 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="  20 C"></a-button>
      <a-button id="boton500horno" scale="1.05 1 1" position ="-8 1.2 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value=" 500 C"></a-button>
      <a-button id="boton1000horno" scale="1 1 1" position ="-8 1.6 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="1000 C"></a-button>
      <a-button id="boton2000horno" scale="1 1 1" position ="-8 2 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="2000 C"></a-button>
      <!-- Fin btn Horno  -->

      <!-- btn Frigorifico  -->
      <a-button id="botonfrigorifico" scale="2 2 2" width="1.2" position="0.6 3 -3.499" value="Frigorifico" button="buttonColor:#fd0e0b"></a-button>
      <a-button id="boton20frigorifico" scale="1.05 1 1" position ="-0.8 2 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="  20 C"></a-button>
      <a-button id="boton0" scale="1.1 1 1" position ="-0.8 1.6 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value=" 0 C"></a-button>
      <a-button id="boton150" scale="1 1 1" position ="-0.8 1.2 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="-150 C"></a-button>
      <a-button id="boton273" scale="1 1 1" position ="-0.8 0.8 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="-273 C"></a-button>
      <!-- Fin btn Frigorifico  -->

      <!-- Horno 3D  -->
      <a-button id="botonhorno3d" scale="2 2 2" position="7 3.5 -2.4" value="horno" rotation="0 -32 0" button="buttonColor:#fd0e0b"></a-button>
      <a-button id="boton20horno3d" scale="1.1 1 1" position ="4.4 1.2 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="  20 C"></a-button>
      <a-button id="boton-273horno3d" scale="1.05 1 1" position ="4.4 0.8 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value=" -273 C"></a-button>
      <a-button id="cambioFigura" scale="1 1 1" position ="4.4 2 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="cambio"></a-button>
      <a-button id="boton2000horno3d" scale="1 1 1" position ="4.4 1.6 -3.499" material="color:blue; shader:flat" rotation="0 0 0" value="2000 C"></a-button>
      <!-- Fin Horno 3D  -->

      <!-- paredes 3D  -->
      <a-plane id="pared1" material="color:grey;shader:flat" scale="6.5 4 2" position="-9.75 2 -3.5" rotation="" geometry=""></a-plane>
      <a-plane id="pared2" material="color:grey;shader:flat" scale="11 2 2" position="-1.5 3 -3.5" rotation="" geometry=""></a-plane>
      <a-plane id="pared3" material="color:grey;shader:flat" scale="4 4 4" position="-1.5 2 -3.5" rotation="" geometry=""></a-plane>
      <a-plane id="pared4" material="color:grey;shader:flat" scale="2.4 4 4" position="4.700198810232626 2 -3.5" rotation="" geometry=""></a-plane>
      <a-plane id="pared5" material="color: #707070;shader:flat" scale="10.50011 4 4" position="10 2 4.75" rotation="0 -90 0" geometry=""></a-plane>
      <a-plane id="pared6"  material="color: grey; shader: flat" scale="23 4 4" position="-1.5 2 10" rotation="180 0 0"></a-plane>
      <a-plane id="pared7"  material="color: #707070; shader: flat" scale="14 4 4" position="-13 2 3" rotation="0 90 0"></a-plane>
      <a-plane id="pared8" material="color:grey;shader:flat" scale="6.5 1 2" position="8.231886792537802 3.5 -1.8654553143192079" rotation="0 -32 0" ></a-plane>
      <a-plane id="pared9" material="color:grey;shader:flat" scale="0.3 4 2" position="5.62749882070162 2 -3.358539054096435" rotation="0 -32 0" geometry=""></a-plane>
      <!-- fin paredes 3D  -->

      <a-entity id="paredcircular1" obj-model="obj:/objetos/paredcircular.obj;mtl:/objetos/paredcircular.mtl" scale="0.04 0.1 0.04" position="9.3 0 -4" rotation="270 -32 0"></a-entity>
      <a-entity id="horno1" obj-model="obj: #horno-obj;mtl: #horno-mtl" scale="0.01 0.01 0.01" position="-5 0 -3.5" rotation="270 32 0"></a-entity>
      <a-entity id="horno2" obj-model="obj: #horno-obj;mtl: #horno-mtl" scale="0.01 0.01 0.01" position="2 0 -3.5" rotation="270 32 0"></a-entity>
      <a-entity id="horno3" obj-model="obj: #horno-obj;mtl: #horno-mtl" scale="0.015 0.015 0.015" position="8 0 -2" rotation="270 0 0"></a-entity>


			<!--a-button id="btn1" color="blue" position="0 0.5 -3" value="0"></a-button>
			<a-button id="btn2" color"green" position="1 0.5 -3" value="20"></a-button>
			<a-button id="btn3" color="red" position="2 0.5 -3" value="50"></a-button-->

			<a-entity id="cylinders">
        <!-- Frigorifico -->
				<a-cylinder id="cylinder1" position="1.2 0.95 -5" radius="0.2" height="1.5" color="#FFC65D" shadow></a-cylinder>
				<a-cylinder id="cylinder2" position="2 0.95 -5" radius="0.2" height="1.5" color="#FFC65D" shadow></a-cylinder>
				<a-cylinder id="cylinder3" position="2.8 0.95 -5" radius="0.2" height="1.5" color="#FFC65D" shadow></a-cylinder>
        <!-- horno -->
        <a-cylinder id="cylinder4" position="-5.6 0.95 -5" radius="0.2" height="1.5" color="#FFC65D" shadow></a-cylinder>
				<a-cylinder id="cylinder5" position="-4.8 0.95 -5" radius="0.2" height="1.5" color="#FFC65D" shadow></a-cylinder>
				<a-cylinder id="cylinder6" position="-4 0.95 -5" radius="0.2" height="1.5" color="#FFC65D" shadow></a-cylinder>
      </a-entity>

      <a-entity id="volumes">
				<a-sphere id="vol1" color="green" position="9 1.25 -3.4" radius="1" color="#EF2D5E" shadow></a-sphere>
				<a-box id="vol2" color="green" position="9 1.25 -3.4" height="2" width="1" depth="1" visible="false"></a-box>
			</a-entity>



      <!-- etiquetas -->
      <a-text id="AuHorno" class='etiquetas' position="-6 1 -3.4" value="Au" scale="1 1 1" visible='false'></a-text>
      <a-text id="AgHorno" class='etiquetas' position="-5.6 1 -3.4" value="Ag" scale="1 1 1" visible='false'></a-text>
      <a-text id="CuHorno" class='etiquetas' position="-5.2 1 -3.4" value="Cu" scale="1 1 1" visible='false'></a-text>

      <a-text id="AuFrigorifico" class='etiquetas' position="1 1 -3.4" value="Au" scale="1 1 1" visible='false'></a-text>
      <a-text id="AgFrigorifico" class='etiquetas' position="1.5 1 -3.4" value="Ag" scale="1 1 1" visible='false'></a-text>
      <a-text id="CuFrigorifico" class='etiquetas' position="2  1 -3.4" value="Cu" scale="1 1 1" visible='false'></a-text>


			<!-- boton tutorial -->
			<a-button  class="btn_tutorial" id="btn_tooltips" color="blue" position="-2 1 -3" value="Tutorial"></a-button>
			<!-- fin boton tutorial -->

      <!-- Inicio de Controles -->
      <a-entity id='cameraWrapper' position="0 0 3">
        <a-animation begin="movement" attribute="position" dur="10000" fill="none"></a-animation>
        <a-camera id="camera" look-controls-enabled wasd-controls-enabled>
					<!-- tooltips -->
					<a-entity id="tooltips">
						<a-entity id="hint_rectangle" slice9="width: 1; height: 0.3; left: 20; right: 43; top: 20; bottom: 43; src: assets/images/tooltip.png; transparent: true; opacity: 0;" position="0.04 0.44 -1.3"></a-entity>
						<a-entity material="opacity: 0;" id="hints" text="font: roboto ; value: Ook, pongamonos serios. Veamos si el test de los mensajes funciona bien ; color: white; width: 0.8; wrap-pixels: 800; opacity: 0" position="0.06 0.41 -1.2" visible="false"></a-entity>
					</a-entity>
					<!-- fin tooltips -->
          <a-entity id="selector" cursor="fuse: true; fuseTimeout: 1000"
              position="0 0 -1"
              geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
              material="color: black; shader: flat">
              <a-animation begin="click" easing="ease-in" attribute="scale" dur="150" fill="forwards" from="0.1 0.1 0.1" to="1 1 1"></a-animation>
              <a-animation begin="cursor-fusing" easing="ease-in" attribute="scale" dur="1000" fill="backwards" from="1 1 1" to="0.1 0.1 0.1"></a-animation>
            </a-entity>
          </a-camera>
      </a-entity>

      <!-- Fin de Controles -->
    </a-scene>
  </body>
  <script>

			class Hint {
				constructor() {
					this.btn_tooltips = document.querySelector('#btn_tooltips');
					this.hint_rectangle = document.querySelector("#hint_rectangle");
					this.dom = document.querySelector("#hints");
					this.active = false;
					this.step = 0;
					// Cambios necesarios tutorial
					this.frig_count = 2;
					this.horno_count = 2;
					this.vol_count = 2;
					this.frig_count_A = 2;
					this.horno_count_A = 2;
					this.changeHintText("Hola, bienvenido a la experiencia N°3 de umVRal: Dilatación Termica. Para comenzar, coloca la mira en la palabra Frigorifico.");
				}
				reset() {
					this.step = 1;
					this.active = false;
					this.change_temp = 0;
					//tengo q cambiar angulo horizontal 2 veces
					this.pos_count = 3;
					this.angle_count = 3;
				}
				fade_in() {
					let that = this;
					that.active = true;
					that.dom.setAttribute('visible', true);
					setTimeout(function(){ 
						that.hint_rectangle.setAttribute('animation',"property: slice9.opacity; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: 0.7");
						that.dom.setAttribute('animation',"property: text.opacity; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: 0.8");
						//that.step = 1;
					}, 500);
				}
				fade_out() {
					let that = this;
					this.active = false;
					setTimeout(function(){ 
						that.hint_rectangle.setAttribute('animation',"property: slice9.opacity; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: 0");
						that.dom.setAttribute('animation',"property: text.opacity; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: 0");
					}, 4000);
				};
				changeHintText(text) {
					this.dom.setAttribute('text', {'value': text}) 
				}

				/* Funciones de Pasos*/
				toStep1(){
					let that = this;
					if (that.step === 0){
						that.changeHintText('Cambia la temperatura del Frigorico unas '+that.frig_count+' veces, colocando la mira en las temperaturas.');
						that.step = 1;
					}
				}
				toStep1A(){
					let that = this;
					if (that.step === 1){
						that.changeHintText('Selecciona elementos dentro del Frigorifico unas '+that.frig_count_A+' veces, para ver los elementos y su largo.');
						that.step = 11;
					}
				}
				toStep2(){
					let that = this;
					if (that.step === 11){
						that.changeHintText('Bien!. Cambia de vista hacia el horno, mirando a tu izquierda la palabra Horno.');
						that.step = 2;
					}
				}
				toStep3(){
					let that = this;
					if (that.step === 2){
						that.changeHintText('Cambia la temperatura del Horno unas '+that.horno_count+' veces, colocando la mira en las temperaturas.');
						that.step = 3;
					}
				}
				toStep3A(){
					let that = this;
					if (that.step === 3){
						that.changeHintText('Selecciona elementos dentro del Horno unas '+that.horno_count_A+' veces, para ver los elementos y su largo.');
						that.step = 33;
					}
				}
				toStep4(){
					let that = this;
					if (that.step === 33){
						that.changeHintText('Super!. Cambia de vista hacia el otro horno, mirando bien a tu derecha la palabra Horno.');
						that.step = 4;
					}
				}
				toStep5(){
					let that = this;
					if (that.step === 4){
						that.changeHintText('Cambia la temperatura del Horno unas '+that.horno_count+' veces, colocando la mira en las temperaturas.');
						that.step = 5;
					}
				}
				toStep6(){
					let that = this;
					if (that.step === 5){
						that.changeHintText('Excelente!. Prueba apretando el botón "cambio" para cambiar el objeto visible.');
						that.step = 6;
					}
				}
				toStep7(){
					let that = this;
					if (that.step === 6){
						that.changeHintText('Super!. Estas listo para poder disfrutar la experiencia. Para regresar al inicio, mira a la ampolleta triangular sobre el techo.');
						that.fade_out();
						that.step = 7;
					}
				}
				/* funciones conteo y auxiliares */
				change_frig(){
					let that = this;
					if (that.step === 1){
						that.frig_count--;
						if (that.frig_count === 1) {that.changeHintText('Cambia la temperatura del Frigorico '+that.frig_count+' vez, colocando la mira en las temperaturas.');}
						else {that.changeHintText('Cambia la temperatura del Frigorico unas '+that.frig_count+' veces, colocando la mira en las temperaturas.');}
						if (that.frig_count <= 0){
							that.toStep1A();
						}
					}
				}
				change_frig_A(){
					let that = this;
					if (that.step === 11){
						that.frig_count_A--;
						if (that.frig_count_A === 1) {that.changeHintText('Selecciona elementos dentro del Frigorifico '+that.frig_count_A+' vez, para ver los elementos y su largo.');}
						else {that.changeHintText('Selecciona elementos dentro del Frigorifico unas '+that.frig_count_A+' veces, para ver los elementos y su largo.');}
						if (that.frig_count_A	<= 0){
							that.toStep2();
						}
					}
				}
				change_horno(){
					let that = this;
					if (that.step === 3){
						that.horno_count--;
						if (that.horno_count === 1) {that.changeHintText('Cambia la temperatura del Frigorico '+that.horno_count+' vez, colocando la mira en las temperaturas.');}
						else {that.changeHintText('Cambia la temperatura del Frigorico unas '+that.horno_count+' veces, colocando la mira en las temperaturas.');}
						if (that.horno_count <= 0){
							that.toStep3A();
						}
					}
				}
				change_horno_A(){
					let that = this;
					if (that.step === 33){
						that.horno_count_A--;
						if (that.horno_count_A === 1) {that.changeHintText('Selecciona elementos dentro del Horno '+that.horno_count_A+' vez, para ver los elementos y su largo.');}
						else {that.changeHintText('Selecciona elementos dentro del Horno unas '+that.horno_count_A+' veces, para ver los elementos y su largo.');}
						if (that.horno_count_A <= 0){
							that.toStep4();
						}
					}
				}
				change_vol(){
					let that = this;
					if (that.step === 5){
						that.vol_count--;
						if (that.vol_count === 1) {that.changeHintText('Cambia la temperatura del Frigorico '+that.vol_count+' vez, colocando la mira en las temperaturas.');}
						else { that.changeHintText('Cambia la temperatura del Frigorico unas '+that.vol_count+' veces, colocando la mira en las temperaturas.');}
						if (that.vol_count <= 0){
							that.toStep6();
						}
					}
				}
			}
			hints = new Hint();

		hints.btn_tooltips.addEventListener('click', function(){
			hints.fade_in();
			pay = {
				student_id: 301,
				experience_id: 3,
				slug: 'tutorial',
				value: true,
				//value_num: algun numero
			}
			this.setAttribute('visible', 'false');
			//send2api(pay);
		})

    var boolEsfera = 1;
    var sphere = document.querySelector("#sphere");
		var initHeight = 1.5;
    //temperaturas
		var temp = [200,5000,10000,20000,200,0,-1500,-2730];

    //btnes horno
    var btn1 = document.querySelector('#boton20horno');
    var btn2 = document.querySelector('#boton500horno');
    var btn3 = document.querySelector('#boton1000horno');
    var btn4 = document.querySelector('#boton2000horno');

    var suelohorno = document.querySelector('#suelohorno');
    var suelorefri = document.querySelector('#suelorefri');

    //btnes Frigorifico
    var btn5 = document.querySelector('#boton20frigorifico');
    var btn6 = document.querySelector('#boton0');
    var btn7 = document.querySelector('#boton150');
    var btn8 = document.querySelector('#boton273');

    var suelorefri = document.querySelector('#suelorefri');

    //btnes Horno3D
    var btn9 = document.querySelector('#boton-273horno3d');
    var btn10 = document.querySelector('#boton20horno3d');
    var btn11 = document.querySelector('#boton2000horno3d');
    //cambio de figura
    var btnCambio = document.querySelector('#cambioFigura');

    class termicObject{
      constructor(element){
        this.alpha = element.alpha
        this.color = element.color
      }
      assignElement(element){
        this.alpha = element.alpha
        this.color = element.color
        return true
      }
    }

		// alpha esta en unidad 10^-6 C°^-1
		var coef = {
			'oro' : {alpha: 14, color: '#D7C505'},
			'cobre' : {alpha: 17, color: '#D17813'},
			'plata' : {alpha: 19, color: '#9D9D9D'},
			'aluminio' : {alpha: 23, color: '#7E8CA9'},
			'hierro' : {alpha: 12, color: '#555D6E'},
		}

		var coef_vol = {
			'oro' : {alpha: 42, color: '#D7C505'},
			'cobre' : {alpha: 51, color: '#D17813'},
			'plata' : {alpha: 54, color: '#9D9D9D'},
			'aluminio' : {alpha: 69, color: '#7E8CA9'},
			'hierro' : {alpha: 33.3, color: '#555D6E'},
		}

    //oro congelador
		cylinder1 = new termicObject(coef.oro)
		cylinder1.dom = document.querySelector("#cylinder1");
    //plata congelador
		cylinder2 = new termicObject(coef.plata)
		cylinder2.dom = document.querySelector("#cylinder2");
    //cobre congelador
		cylinder3 =new termicObject(coef.cobre)
		cylinder3.dom = document.querySelector("#cylinder3");
    //oro horno
    cylinder4 = new termicObject(coef.oro)
		cylinder4.dom = document.querySelector("#cylinder4");
    //plata horno
		cylinder5 = new termicObject(coef.plata)
		cylinder5.dom = document.querySelector("#cylinder5");
    //cobre horno
		cylinder6 = new termicObject(coef.cobre)
		cylinder6.dom = document.querySelector("#cylinder6");

		volume1 = coef_vol.oro
		volume1.dom = document.querySelector("#vol1");
		volume1.position_org = volume1.dom.getAttribute('position')
		volume1.original = volume1.dom.getAttribute('geometry')

		volume2 = coef_vol.aluminio
		volume2.dom = document.querySelector("#vol2");
		volume2.position_org = volume2.dom.getAttribute('position')
		volume2.original = volume2.dom.getAttribute('geometry')


    var teleporthorno = document.querySelector('#botonhorno');
		var teleportfrigorifico = document.querySelector('#botonfrigorifico');
    var teleport3d = document.querySelector('#botonhorno3d');
    var teleportinicio = document.querySelector('#panelquimico');

    initDom()

    teleporthorno.addEventListener('click',function(){
      $("#cameraWrapper").object3D.position.set(-6,0,0);
			hints.toStep3();
    })

    teleportfrigorifico.addEventListener('click',function(){
			hints.toStep1();
      $("#cameraWrapper").object3D.position.set(1,0,0);
    })

    teleport3d.addEventListener('click',function(){
      $("#cameraWrapper").object3D.position.set(5,0,1);
			hints.toStep5();
    })

    teleportinicio.addEventListener('click', function(){
      $("#cameraWrapper").object3D.position.set(0,0,3);
    })

    $('#volverInicio').addEventListener('click', function(){
      $("#cameraWrapper").object3D.position.set(0,0,3);
    })

    btnCambio.addEventListener('click',function(){
			hints.toStep7();
      if(boolEsfera){
         $('#vol1').setAttribute('visible','false');
         $('#vol2').setAttribute('visible','true');
         boolEsfera = 0;
      }else {
         $('#vol1').setAttribute('visible','true');
         $('#vol2').setAttribute('visible','false');
         boolEsfera = 1;
      }
    })

    cylinder1.dom.addEventListener('click',function(){
      oculatarEtiquetas();
      document.querySelector('#AuFrigorifico').setAttribute('visible',true);
			hints.change_frig_A();
    })

    cylinder2.dom.addEventListener('click',function(){
      oculatarEtiquetas();
      document.querySelector('#AgFrigorifico').setAttribute('visible',true);
			hints.change_frig_A();

    })

    cylinder3.dom.addEventListener('click',function(){
      oculatarEtiquetas();
      document.querySelector('#CuFrigorifico').setAttribute('visible',true);
			hints.change_frig_A();

    })



    cylinder4.dom.addEventListener('click',function(){
      oculatarEtiquetas();
      document.querySelector('#AuHorno').setAttribute('visible',true);
			hints.change_horno_A();

    })

    cylinder5.dom.addEventListener('click',function(){
      oculatarEtiquetas();
      document.querySelector('#AgHorno').setAttribute('visible',true);
			hints.change_horno_A();

    })

    cylinder6.dom.addEventListener('click',function(){
      oculatarEtiquetas();
      document.querySelector('#CuHorno').setAttribute('visible',true);
			hints.change_horno_A();

    })


    //horno 20
    btn1.addEventListener('click', function(){
			changeLength(temp[0],0);
			hints.change_horno();
		})
    //horno 500
    btn2.addEventListener('click', function(){
			changeLength(temp[1],0);
			hints.change_horno();
		})
    //horno 1000
    btn3.addEventListener('click', function(){
			changeLength(temp[2],0);
			hints.change_horno();
		})
    //horno 2000
    btn4.addEventListener('click', function(){
			changeLength(temp[3],0);
			hints.change_horno();
		})

    //refri 20
    btn5.addEventListener('click', function(){
      console.log("btn 5");
			hints.change_frig();
			changeLength(temp[4],1);

		})


    //refri 0
    btn6.addEventListener('click', function(){
      console.log("btn 6");
			hints.change_frig();
			changeLength(temp[5],1);
		})
    //refri -150
    btn7.addEventListener('click', function(){
      console.log("btn 7");
			hints.change_frig();
			changeLength(temp[6],1);

		})
    //refri -273
    btn8.addEventListener('click', function(){
      console.log("btn 8");
			hints.change_frig();
			changeLength(temp[7],1);

		})

    //volume
    btn9.addEventListener('click', function(){
      console.log("btn 8");
			hints.change_vol();
      changeVolume(temp[7]);

    })
    btn10.addEventListener('click', function(){
      console.log("btn 9");
			hints.change_vol();
      changeVolume(temp[5]);

    })
    btn11.addEventListener('click', function(){
      console.log("btn 10");
			hints.change_vol();
      changeVolume(temp[3]);

    })



		function initDom() {
			cylinder1.dom.setAttribute('color',cylinder4.color);
			cylinder2.dom.setAttribute('color',cylinder5.color);
			cylinder3.dom.setAttribute('color',cylinder6.color);
      cylinder4.dom.setAttribute('color',cylinder4.color);
			cylinder5.dom.setAttribute('color',cylinder5.color);
			cylinder6.dom.setAttribute('color',cylinder6.color);
			//btn1.setAttribute('value',temp[0]+'°');
			//btn2.setAttribute('value',temp[1]+'°');
			//btn3.setAttribute('value',temp[2]+'°');
      $('#CuHorno').setAttribute('value','Cu\n 1.5[m]');
      $('#AuHorno').setAttribute('value','Au\n 1.5[m]');
      $('#AgHorno').setAttribute('value','Ag\n 1.5[m]');
			volume1.dom.setAttribute('color',volume1.color);
			volume2.dom.setAttribute('color',volume2.color);
		}


    function oculatarEtiquetas(){
      var etiquetados = document.querySelectorAll('.etiquetas');
      console.log(etiquetados);
      for(item of etiquetados){
        item.setAttribute('visible','false');
      }
    }
    /*
     * tipo { 0 : horno , 1 : Frigorifico  }
     */
		function changeLength(temp,tipo){
      if(tipo == 0){
        length4 = getLength(initHeight,cylinder4,temp);
        length5 = getLength(initHeight,cylinder5,temp);
        length6 = getLength(initHeight,cylinder6,temp);
        REALlength4 = getLengthReal(initHeight,cylinder4,temp);
        REALlength5 = getLengthReal(initHeight,cylinder5,temp);
        REALlength6 = getLengthReal(initHeight,cylinder6,temp);
        $('#CuHorno').setAttribute('value','Cu\n'+REALlength6+'[m]');
        $('#AuHorno').setAttribute('value','Au\n'+REALlength4+'[m]');
        $('#AgHorno').setAttribute('value','Ag\n'+REALlength5+'[m]');
        cylinder4.dom.setAttribute('animation',"property: height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length4);
        cylinder5.dom.setAttribute('animation',"property: height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length5);
        cylinder6.dom.setAttribute('animation',"property: height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length6);
        cylinder4.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length4/2);
        cylinder5.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length5/2);
        cylinder6.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length6/2);
        console.log(backgroundColor(temp,tipo));
        suelohorno.setAttribute('animation__color',"property: material.color; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+backgroundColor(temp,tipo));

      }
      if(tipo == 1){
        length1 = getLength(initHeight,cylinder1,temp);
        length2 = getLength(initHeight,cylinder2,temp);
        length3 = getLength(initHeight,cylinder3,temp);
        REALlength1 = getLengthReal(initHeight,cylinder1,temp);
        REALlength2 = getLengthReal(initHeight,cylinder2,temp);
        REALlength3 = getLengthReal(initHeight,cylinder3,temp);
        $('#CuFrigorifico').setAttribute('value','Cu\n'+REALlength3+'[m]');
        $('#AuFrigorifico').setAttribute('value','Au\n'+REALlength1+'[m]');
        $('#AgFrigorifico').setAttribute('value','Ag\n'+REALlength2+'[m]');
        cylinder1.dom.setAttribute('animation',"property: height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length1);
        cylinder2.dom.setAttribute('animation',"property: height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length2);
        cylinder3.dom.setAttribute('animation',"property: height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length3);
        cylinder1.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length1/2);
  			cylinder2.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length2/2);
  			cylinder3.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+length3/2);
        console.log(backgroundColor(temp,tipo));
        suelorefri.setAttribute('animation__color',"property: material.color; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+backgroundColor(temp,tipo));
      }

		}


    function getLengthReal(L_o, obj, temp){
      temp = temp/10;
      console.log(L_o + (obj.alpha*Math.pow(10,-6)*L_o*temp));
      console.log(obj.alpha);
			return L_o + (obj.alpha*Math.pow(10,-6)*L_o*temp)
		}

		function getLength(L_o, obj, temp){
      oculatarEtiquetas();
      console.log(L_o + (obj.alpha*Math.pow(10,-6)*L_o*temp));
      console.log(obj.alpha);

			return L_o + (obj.alpha*Math.pow(10,-6)*L_o*temp)
		}



		function changeVolume(temp){
			//vol1 : la esfera
			//vol2 : el cubo
      oculatarEtiquetas();
			sphere = volume1.original
			cube = volume2.original
			vol1_ = (4/3)*Math.PI*Math.pow(sphere.radius, 3)
			vol2_ = cube.height*cube.width*cube.depth
      console.log("cambio volumen");
			newvol1 = getVolume(vol1_,volume1,temp)
			newvol2 = getVolume(vol2_,volume2,temp)
			changeVolumeCube(newvol2,volume2)
			changeVolumeSphere(newvol1,volume1)
		}

		function getVolume(V_o, obj, temp){
			return V_o + (obj.alpha*Math.pow(10,-6)*V_o*temp)
		}

		function changeVolumeCube(final_volume,obj){
			cube = obj.original
			x = cube.width
			y = cube.height
			z = cube.depth
			x_ = Math.pow(final_volume*((x*x)/(y*z)),1/3)
			y_ = x_ * (y/x)
			z_ = x_ * (z/x)
			new_y = y_/2
			obj.dom.setAttribute('animation__height',"property: geometry.height; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+y_);
			obj.dom.setAttribute('animation__width',"property: geometry.width; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+x_);
			obj.dom.setAttribute('animation__depth',"property: geometry.depth; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+z_);
			obj.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+new_y);
			return true
		}


    /*
     * tipo { 0 : horno , 1 : Frigorifico  }
     */
    function backgroundColor(t_act,tipo) {
			t_max = temp[3];
			t_min = temp[7];
			if (tipo==0){
				red = Math.round((t_act * 255)/t_max);
				blue = 255 - red;
				result = 'rgb('+red+',0,0)'
			}
			else {
        if(t_act > 0){
            t_act=0;

        }
				white = Math.round((t_act * 255)/t_min);
				//white = 255 - white;
				result = 'rgb('+white+','+white+','+255+')'
			}
			return result;
		}

		function changeVolumeSphere(final_volume,obj){
			sphere = obj.original
			r = sphere.radius
			r_ = Math.pow((final_volume*3)/(4*Math.PI),1/3)
			obj.dom.setAttribute('animation__sphere',"property: geometry.radius; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+r_);
			obj.dom.setAttribute('animation__pos',"property: object3D.position.y; dir: alternate; dur: 1000; easing: easeInSine; loop: false; to: "+r_);
			return true
		}

		/*AFRAME.anime({
			targets: '#sphere',
			color: ['rgb(255,0,0)', '#FFF'], // Animate the background color to #FFF (from 'rgb(0,0,0)' to 'rgb(255,255,255)')
			duration: 1500
		});*/


  </script>
</html>
